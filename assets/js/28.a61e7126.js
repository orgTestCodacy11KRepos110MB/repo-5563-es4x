(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{400:function(t,s,a){"use strict";a.r(s);var e=a(44),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"security-policy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#security-policy"}},[t._v("#")]),t._v(" Security Policy")]),t._v(" "),a("p",[t._v("ES4X allows you to run your applications in a total secure sandbox. Just like "),a("a",{attrs:{href:"https://deno.land/",target:"_blank",rel:"noopener noreferrer"}},[t._v("deno"),a("OutboundLink")],1),t._v(", ES4X can\nisolate the application. The technology behind this is the JVM\n"),a("a",{attrs:{href:"https://docs.oracle.com/javase/tutorial/essential/environment/security.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("security manager"),a("OutboundLink")],1),t._v(". Security managers were\nwhat isolated the old "),a("code",[t._v("Applet")]),t._v(" code from accessing the host machine. They are more fine grained than what you get today\nin "),a("code",[t._v("deno")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"create-a-security-policy"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#create-a-security-policy"}},[t._v("#")]),t._v(" Create a security.policy")]),t._v(" "),a("p",[t._v("To create a security policy, run the "),a("code",[t._v("es4x")]),t._v(" tool:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ es4x security-policy\n\nCreating a new "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'security.policy'")]),t._v(" with full network access and\nread-only IO access to the working directory.\n")])])]),a("p",[t._v("The generated file is a plain template, if you open it you can read:")]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Grant the following permissions to code that shall be executed from")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the node_modules/.lib/* directory")]),t._v("\ngrant codeBase "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"file:\\${user.dir}\\${/}node_modules\\${/}.lib\\${/}*"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vert.x will need full access to the temp dir.")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\${java.io.tmpdir}\\${/}-"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read,write,delete"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// the code should be able to read the JVM/GraalVM runtime libs")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\${java.home}"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\${java.home}\\${/}..\\${/}release"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\${java.home}\\${/}-"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// applications are allowed to read all files from the CWD")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FilePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"\\${user.dir}\\${/}-"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// uncomment the following to allow full read access")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('//permission java.io.FilePermission "<<ALL FILES>>", "read";')]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Netty performs some reflection we need to allow it")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reflect"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ReflectPermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"suppressAccessChecks"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// By default we allow all runtime permissions")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// users may want to restrict this further say for example to")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// deny access to environment variables, etc...")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("lang"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RuntimePermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ES4X setup a nice looking logger")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("logging"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("LoggingPermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"control"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Allow full access to JVM system properties")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("util"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("PropertyPermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"read,write"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// currently we allow all access to the network")]),t._v("\n  permission java"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("SocketPermission "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"*"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"accept,connect,listen,resolve"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("So this template gives full network access and read only access to the all files from the "),a("code",[t._v("CWD")]),t._v(" where the application\nstarted.")]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),a("p",[t._v("Once you know all the required permissions for your application you can start restricting even more!")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),a("p",[t._v("Even though this template looks like a good start, remember that the "),a("code",[t._v("CWD")]),t._v(" is read only, so for example if you're\nrunning and http server that does file uploads, unless the uploads land on the "),a("code",[t._v("$TEMP")]),t._v(" directory, they will fail as\nthere is no way to write from the application.")])])])}),[],!1,null,null,null);s.default=n.exports}}]);